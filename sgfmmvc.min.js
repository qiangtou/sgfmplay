(function(e,k){var h=k.sgfmmvc=k.sgfmmvc||{},l=0;h.Model=function(c){c=c||{};var b=c.defaults||{};this.idArr="id";this.hasChange=e.noop;this.get=function(g){return b[g]};this.getAttrs=function(){return b};this.reset=function(g){b={};return this.set(g)};this.change=function(){};var f=function(g,a){if(g){var d,c,j,e=!1;"string"==typeof g?(d={})[g]=a:d=g;for(var f in d)c=b[f],j=d[f],c!=j&&(b[f]=j,e=!0,this.change(f,c,j));e&&this.hasChange.call(this);return this}};this.set=function(b,a){return f.call(this,
b,a)};this.update=function(b,a){return f.call(this,b,a)};this.fetch=function(b){var a=this,d=this.url,c=b||function(a){this.set(a)};d&&e.ajax({url:d,success:function(d){"function"==typeof b&&c.call(a,d)},dataType:"json"})};e.extend(this,c);b[this.idArr]||(b[this.idArr]=l++)};h.Models=function(c){var b={},f=0;this.length=function(){return f};this.model=null;this.init=e.noop;this.create=function(a){a=new this.model({defaults:a});return g.call(this,a)};var g=function(a){var d=a.get(a.idArr);b[d]||(b[d]=
a,f++);return a};this.add=function(a){return g.call(this,a)};this.del=function(a){a=a.get(a.idArr);b[a]&&(delete b[a],f--);return this};this.empty=function(){b={};f=0};this.toArr=function(){var a=[],d;for(d in b)a.push(b[d]);return a};this.getById=function(a){return b[a]};this.get=function(a){var d=0;for(m in b)if(d++,d==a)return b[m]};this.reset=function(a){this.empty();for(var b=a.length;b--;)this.create(a[b]);return this};this.fetch=function(a){var b=this,c=this.url;c&&e.ajax({url:c,success:function(c){"function"==
typeof a&&a.call(b,c)},dataType:"json"})};e.extend(this,c);this.init.call(this,c)};h.View=function(c){var b=this,f={},g={};this.f=function(){return g};this.init=e.noop;this.$=e("<div></div>");this.render=e.noop;this.events={};this.listenTo=function(a,d,c){if(a){var j,h;j=d.split(":");d=j[0];"change"==d&&(j=j[1])&&(g[j]=c);h=f[d]||(f[d]=a[d])||e.noop;a[d]=function(){var f,e;e=arguments[0];f=h.apply(a,arguments);(e="change"==d?g[e]:c)&&e.apply(b,arguments);return f}}};this.addEvents=function(){var a,
b,c,f=this.events;for(c in f)a=c.split(" "),b=a[0],a=a[1],fun=f[c],"string"==typeof fun&&(fun=this[fun]),this.$.delegate(b,a,e.proxy(fun,this))};this._init=function(){e.extend(b,c);var a=this.tag;a&&(this.$=e("<"+a+"></"+a+">"));(a=this.cls)&&this.$.addClass(a);this.init.call(this,c);this.addEvents.call(this,c)};this._init()};h.Model.extend=h.Models.extend=h.View.extend=function(c){var b=this;return function(f){return new b(e.extend(c,f))}};h.replace=function(c,b){if(!b)return c;b instanceof h.Model&&
(b=b.getAttrs());return c.replace(/{(.*?)}/igm,function(c,e){var a=b[e];return"undefinde"!=a?a:c})}})(jQuery,window);
