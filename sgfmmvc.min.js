(function(e,h){var g=h.sgfmmvc=h.sgfmmvc||{},l=0;g.Model=function(c){c=c||{};var b=c.defaults||{};this.idArr="id";this.hasChange=e.noop;this.get=function(f){return b[f]};this.getAttrs=function(){return b};this.reset=function(f){b={};return this.set(f)};this.set=function(f,a){if(f){var d,k,e,c=!1;"string"==typeof f?(d={})[f]=a:d=f;for(var g in d)k=b[g],e=d[g],k!=e&&(b[g]=e,c=!0,this.change(g,k,e));c&&this.hasChange.call(this);return this}};this.change=function(b,a,d){console&&console.log&&console.log(this.idArr+
":"+this.get(this.idArr)+",["+b+"] changed from ["+a+"] to ["+d+"]")};this.fetch=function(b){var a=this,d=this.url,c=b||function(a){this.set(a)};d&&e.ajax({url:d,success:function(d){"function"==typeof b&&c.call(a,d)},dataType:"json"})};e.extend(this,c);b[this.idArr]||(b[this.idArr]=l++)};g.Models=function(c){var b={},f=0;this.length=function(){return f};this.model=null;this.init=e.noop;this.create=function(a){a=new this.model({defaults:a});return this.add(a)};this.add=function(a){var d=a.get(a.idArr);
b[d]||(b[d]=a,f++);return a};this.del=function(a){a=a.get(a.idArr);b[a]&&(delete b[a],f--);return this};this.empty=function(){b={};f=0};this.toArr=function(){var a=[];for(m in b)a.push(b[m]);return a};this.getById=function(a){return b[a]};this.get=function(a){var d=0;for(m in b)if(d++,d==a)return b[m]};this.reset=function(a){this.empty();for(var d=a.length;d--;)this.create(a[d]);return this};this.fetch=function(a){var d=this,b=this.url;b&&e.ajax({url:b,success:function(b){"function"==typeof a&&a.call(d,
b)},dataType:"json"})};e.extend(this,c);this.init.call(this,c)};g.View=function(c){var b=this,f={},a={};this.init=e.noop;this.$=e("<div></div>");this.render=e.noop;this.events={};this.listenTo=function(d,c,g){var j,h;j=c.split(":");c=j[0];(j=j[1])&&(a[j]=g);h=f[c]||(f[c]=d[c])||e.noop;d[c]=function(){var c,f=arguments[0];c=h.apply(d,arguments);(a[f]||g||e.noop).apply(b,arguments);return c}};this.addEvents=function(){var a,b=this.events;for(eventsStr in b)a=eventsStr.split(" "),selector=a[0],eventType=
a[1],fun=b[eventsStr],"string"==typeof fun&&(fun=this[fun]),this.$.delegate(selector,eventType,e.proxy(fun,this))};this._init=function(){e.extend(b,c);var a=this.tag;a&&(this.$=e("<"+a+"></"+a+">"));(a=this.cls)&&this.$.addClass(a);this.init.call(this,c);this.addEvents.call(this,c)};this._init()};g.Model.extend=g.Models.extend=g.View.extend=function(c){var b=this;return function(f){return new b(e.extend(c,f))}};g.replace=function(c,b){return c.replace(/{(.*?)}/igm,function(c,a){return b[a]||c})}})(jQuery,
window);
